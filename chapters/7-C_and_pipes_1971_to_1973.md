# 1971-1973，C语言和管道

在贝尔实验室的个个部门中Unix无疑是成功的。几个月后，Thompson和Ritchie开始为一个新的手册工作。1972年6月中旬发布了第二版。前言部分写着：

> 在这个手册发行后几个月内，系统自身和它的操作方式都有了巨大的变化。

> ...

> 有更多的人花费时间参与到UNIX的开发中来。感谢L.L.Cherry，M.D.McIlroy，L.E.McMahon，R.Morris，以及J.F.Ossanna做出的贡献。

> 最后，UNIX已经安装到了10台机器上。

第一批安装用户当然是研究部门和法务部门。新泽西中部以外的首位用户是Neil Groundwater，那时他在纽约电话中心工作(如今在Sun公司)。他告诉我说：

> 1972年我在滨州州立大学完成学士学位后加入纽约电话公司。那是计算机专业的毕业生就业是很困难的，我被雇佣的原因是我在大学里有一些使用迷你计算机(ADAGE图形系统)的经验。1972年春天我去新泽西维泊尼的贝尔实验室工作。我在曼哈顿有个房子并且没有汽车，周一早上坐汽车去维泊尼对我来说很方便，然后在那里找个旅馆住下周五再返回纽约。一周都住在公司附近让我很快就沉浸在工作中。我对工作的记忆最多的是一个分享Unix系统如何使用的回忆：这和从烟囱内部向上爬非常想，你不得不从底层的方方面面一点点的开始。系统的很多部分的确是有文档，但是就像我们很多年后所说的“去看源码，卢克”。

> 我在维泊尼工作小组的任务是将外部设备的分析工作机械化，其中包括纽约的ESS(电子开关系统)站点。ESS的机器在中央办公室的电传打字机上产生呼叫失败消息(我们称之为“TN08”)。虽然Unix主机并不连接控制“开关”，但可以使用巧妙的线路让一个调制解调器连接电传打字机，另一个调制解调器连接到我们办公室(曼哈顿麦迪逊达到330号14层)，如此就可以发送信号到一个多路复用端口。

> 1972年夏天纽约站点的硬件运到了：

> ```
DEC PDP-11/20处理器
56Kb核心内存
高速纸带读写器
ASR-33 电传控制台
DEC tape
RK11/RK05磁盘 2.4Mb
RF11固定磁头磁盘(最初由两个，后来又添加了3个)
DC11(6路)终端
DM11 16路多路复用器
```

> 我的第一个编程任务是为DM11多路复用器重写驱动来处理多个多路复用器(目标是3个)...

> Unix的shell程序存放在七页行式打印纸中。没有任何的程序库，直接使用系统调用控制读写。shell中有很多我们今天仍在期盼的特性：输入输出重定向(不使用管道)，元字符扩展(虽然是使用/etc/glob的外部程序执行扩展)，还有少量的shell脚本。

> 一个有问题的程序可以很轻松的覆写内核代码。PDP-11的**halt**命令是代码“0”，因此你可以想象使用寄存器指针清空一个内存引用会使CPU立即停止工作。你可以通过编写程序或者使用键盘快捷键转储一个用户程序，这就是故障后调试。


