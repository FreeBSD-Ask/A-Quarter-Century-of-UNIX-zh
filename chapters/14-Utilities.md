# 实用工具

每个 Unix 机器上都安装着数目繁多的程序，不管是系统原生的还是厂商附加的。这其中包括编辑器，格式器，编译器。实用工具使得用户有一个字母列表跟踪程序或者文档的不同版本，去“伸手戳一下”其他用户。这章将用来讲述它们中的一部分：非常早期的——**troff**，**eqn**，**tbl**，**yacc**，**mail**，**make**，**awk**，还有最近出现的——UUCP，TCP/IP。最后两个又引发了其他的实用工具 (Mike Muuss 的 ping 和 Earl Cohen 的 finger 就是很好的例子)，并且几乎立即就出现了一个世界范围的由各种不同用户组成的社区。这个社区对 Unix 来时及其重要。各种问题，解决方案，程序，抱怨，宣告等等都在社区里自由的交换传送。整个社区建立在大约 3000 万到 3500 万的网络用户之上——就像 John Quarterman 所说的，比加拿大的总人口都要多。

mail 和 roff 以及 ed 一样，在 Unix 第一版时就存在了。Morris 曾经将 roff 移植到 635 上，McIlroy 用 BCPL 语言将它重写。Thompson 将它移植到了 Unix。但 Joe Ossanna 不久又将 roff 合并到了 troff，一个真正针对电传打字机文档的格式器。Ossanna 死于 1977 年 11 月 28，McIlroy 告诉我：

> Joe 是军需官，他游走于各个厂商，打探硬件的最新发展，和设备部门做交易，还做了很多很多其他的事。他是一个严厉而有吸引力的人。

eqn 在第 5 版的时候加入进来。Brian Kernighan 说这是他对 Unix 做出的第一个重大贡献。就像他向 Collinson 说的：

> 那个时候所有的程序都是用汇编语言写成的。troff 的最早版本应该是在 1972 年晚期或者 1973 年写的，它是一个汇编语言程序并且只针对特定的图形排字机系统。在今天仍然有许多事情依然受到 troff 语言那古老机器语法的影响。

> Joe Ossanna 将它转换成 C 语言，我认为他受到了相当大的影响，他并不真的想将它转为 C 语言。他死于 1977 年，之后我接手了它的工作，事实上，虽然我花费了至少一年半的时间试着去编译它。我开始让它独立于图形排版系因为那时它的优势已经很明显了。我开始投入到图形中因为新型的默根瑟勒排版机可以做一些受限的图形操作，你可以非常精细的定位，你可以画直线和曲线。

> Mike Lesk 大概在 1975 年做了 **tbl**，在 Lorinda Cherry 和我做出 **eqn** 不久之后 (Cherry 告诉我他开始着手项目的时候 Kernighan 就加入了，但 Kernighan 因为非常成功的语法而出名)。**eqn** 是第一个文档预处理器。它是我们强行实现的一个好主意，需求是发明之母。**troff** 几乎用尽了 PDP-11/40s 的所有地址空间，它用汇编语言写成。我从来没有学过 PDP-11s 的汇编，我想 Honeywell 是最后一个我知道汇编语言的机器。

> Joe 独自保持维护 **troff**，他对于修改它使它工作有着难以置信的兴趣。但这是他的程序，他不想让其他人参加进来。这些事情加起来意味着 Lorinda 和我不得不去做一个分割程序。

> 几个事情合作的非常好。C 语言变得非常具有可用性，yacc 分析生成器刚刚出现，管道也刚被发明出来。所有这些事情一起使商用变得可能。

Kernighan 和 Cherry 实现的“一个数学排版系统”发表在 1975 年 3 月的 CACM 上。1976 年 9 月 14 日，M.E.Lesk 实现的的“Tbl——一个格式化表格”发表在贝尔实验室计算机科学技术报告第 49 期上。和 troff 一起，这些预处理程序使得 Unix 用户可以排版各种各样的复杂文档。精心制作的宏包，增强了的 **-mm**(memorandum) 宏极大地扩展了功能。Mike Lesk 写了 **-ms** 宏，Eric Allman 写了 **-me** 宏。只有 **-ms** 出现在 Unix 的研究版本，**-mm** 出现在第三第四版本。**-me** 和 **-ms** 出现在 BSD(Lesk 还写了 **refer**，可以使用引用数据库提供引用和脚注)。

yacc(yet another compiler-compiler，有一个编译器的编译器)，是 Steve Johnson 的作品。他在 Unix 出现之前很久就已经在贝尔实验室工作了：

> 我在 1963 年有了第一份工作。我总是对计算机感兴趣，当我拿到学士学位，我试着找一个研究生学校。只有很少的地方我可以去，这些地方大部分都属于电力工程部门，在那里我不得不学习发电站的建设以及其他那些我完全不感兴趣的课程，所以我决定去学数学。因此我在 63 年夏天去了贝尔实验室，Tom Growley 是我的第一个老板...那里有一个基本的规矩，你不能连续两个夏天都在同一个组工作。因此下一个夏天我去了 ALPAC 的数学组。再之后的那个夏天，我依照流程去了人类信息处理组，那里有声音，语言，心理方面的人们设计实验和进行数据分析。他们需要做一些多维度的工作，这使得聚类成为我的第一篇论文，它在我所有的出版物种有着最多的引用——一共有 700 之多。

> 当我完成我的论文，我去贝尔实验室。我可以选择我将要去到哪个组，最后我选了人类信息处理组，因为他们会用一些我很感兴趣的计算机音乐。我在那里做了很多事情。也在那个时候，Multics 被认为是繁重计算工作的解决方案，但它是一场灾难。基本上，我们购买了 7094 并把它运送到印第安山实验室，并且除了 645 上的 GECOS 没有其他系统可用。GECOS 可以支持 1000 个用户但是 1 个就会很勉强 (McIlroy 向我指出 645“运行了大量的批处理”)。

> 因此，到了下一年，在极端努力之下这台几百万美元的机器可以运行 FORTRAN 程序了，我同意帮助他们的工作去介绍分时系统。因此在 1969 年我实际上在 Comp 中心和一个小组一起工作。在这些时间里，Comp 中心分化出了计算机科学研究实验室。然后有了办事员，计算机操作员，打卡员等等这些向研究部门汇报的员工。我到那里一年之后，他们才姗姗来迟地设立了一个组织运营计算机中心。我决定宁愿留在研究中心，那样有个后门我可以去做 Unix 的组。

> 我最早是和 Dennis Ritchie 一起工作于另一个叫做 Altran 的计算机代数系统。Dennis 写了 Altran 语言的编译器。它是一个用 FORTRAN 写的递归下降编译器，这绝对是一件杰作，就像用牙签建造了一幢摩天大楼。他曾经为 B 语言写过一个运行在 Honeywell 系统上的编译器，我们用它写一些系统程序。但当他和 Ken 开始为 Unix 工作时，他终止了他的 B 语言编译器，然后我领取了它。这个语言里面有一些我想要的东西，比如我添加了高级 OR 操作符。我从和 Dennis 一起工作中学到了很多编译器的知识，并且这是一个非常体面的工作。我变得相信你可以通过阅读其他人的代码学到非常多的东西。阅读那些杰出的名著。

> 当我想添加这个的时候，我向 Al Aho 请教，因为我听说他对处理表达式的新方法很有兴趣。这是一种非常有趣的情景。Al 不停的点头说:“是的，我读了 Knuth 的这篇论文，这是一个非常好的方法”。所以我们用 B 语言做出一个非常简单的表达式语法，并且他还不断地说“我会给你做出解析表来”。但是它最后还是延期了一些时间。最后，他去仓库找到他们最大的一张纸，足有两平方英尺那么大。他把它平铺在桌子上，裁成小的方形纸，然后他边小声念叨着咒语一样的东西边在上面写下一些小符号。我看着他做了一会，他说:“你为什么不去做些其他的事情？我做完了会给你说的”。我就走开了，没过几个小时回来看时他仍然在念叨着咒语在纸上写写画画。在傍晚的时候他终于说:“我明天把它做完”。最后到了第二天，他说:“完成了！”，然后把它递给我。我说:“我能拿这个做什么？”。

> 他就向我展示怎么做一个解析器，我们一起将表格输入计算机。然后我们就试着解析一些表达式，结果完全正确。接着我们又解析了另一些，但是却出错了，表格里面有一些 bug。Al 说:“喔，天哪”，然后又花费 2，3 个小时擦除重写，最后我们把新的表格输入进去，终于解决了那个 bug，但是却出现了另一个 bug。于是我说:“Al，为什么你不告诉我你在做什么？”。他说:“好吧，这实际上并不难”，然后他交给我怎么制作表格。然后我说:“奥，我可以写个程序来做这个”，“真的？”。于是就诞生了 **yacc**。

Johnson 同时也和 Dennis Ritchie 一起在向 Interdata 8/32 上移植的时候写了第一个可移植的 C 编译器，lint，spell。lint 是一个 C 程序检测器，可以检测 C 代码文件是否有 bug 或者可移植之类的问题。spell 是一个拼写检查器，它从文件搜集单词然后在一个拼写列表里面查找它们，单词既没有出现，也不能从拼写列表推导出来，就把它从标准输出打印出来。spell 不是第一个拼写检查器，第一个拼写错误检查程是 Bob Morris 和 Lorinda Cherry 的 typo。它包含在第三版到第七版。spell 第一次出现在第五版。typo，用 Steve Johnson 的话说：

> 从来没有检查出我的拼写错误。我非常偏重通过发音拼写，经常弄混 ible 和 able，以及 ance 和 ence，但是 typo 从来没有发现这些。它是基于三角统计，我的错误全都出现了。但是 typo 非常擅长找出缺少 e 的 th。它会将单词按最不可能出现的顺序排序。

Johnson 的拼写检查器实际上引用了一个用户可以自行扩展的单词列表。他告诉我：

> 我在 1973 年的 1 月到 9 月去滑铁卢大学学术休假，和 Morven Gentleman(现在在加拿大的国家科研委员会) 一起做一些工作。Morven 曾经在原始的 ALPAC 系统上工作过，他对计算机代数非常感兴趣。我们一起做成了一些工作，他是一个非常有趣的人。事实证明那时不是一个合适的时间。当我去那里时 C 语言刚被发明出来，当我离开时，yacc 被一些人从 B 语言翻译到了 C 语言。同时 MIT 的合作学生 Alan Snyder 也开发了第一个可移植的 C 译言编译器。那是一个非常具有颠覆性的尝试，包含了很多非常好的点子在里面。但因为 PDP-11 内存太小的原因，它是一个四阶编译器。并且它还非常昂贵——每一阶段都将大部分时间花费在读取上一阶段的结果和为下一阶段输出结果，真正做事情的时间反而非常之少。

> 因此它非常的慢，就算老式的 B 语言编译器也要比它快很多。Al 努力让它可以在 Honeywell 工作，但是仍然有许多的 bug。正好，在我从加拿大返回的时候，他也回了 MIT，因此我接手了这个项目。我的老板 Elliott Pinson 强烈建议我我应该接管它。我试着修正代码生成器里面的 bug，发现很大部分都是 Al 做东西的风格。你知道，那时候的代码生成器使用一种我称之为“woopsie”的方式：你确信你有所有需要的寄存器，并且所有的东西都会在正确的位置，当有错误出现时就会发出“woopsie”，然后去找一些东西加载到内存里。大多数时候这都会是一个好的代码，但是当它出了错时那是相当可怕的...

> 好吧，我去向 Al Aho 解释这些，这些谈话导致了我认为我在理论方面最好的技术工作——一个为表达式生成代码的算法，它输出可选择的代码...Al 和我，还有 Jeff Ullman 也做了一些，我们一起做了相当有趣的工作。对我来说最终的结果就是我更好的理解了代码生成。

> 后来，我们为 PDP-11 争取到了更多的内存，这使得我可以将一些 Al Snyder 的程序放在一起运行。不久之后我重写了所有的软件，保留了一点 Al 的语法，但是没有任何他的代码留存下来。我将这个可移植的 C 编译器叫做 pcc。我原本是打算做 Honeywell 的编译器，但后来我们认为将它移植到 IBM 会非常美好。于是我将 Honeywell 版本做了一些 hack，就成了 360 版本。再之后有一个叫做 3A 的交换机，我为他做了一个编译器。在这些过程中我意识到我为这三台机器做了相当多的重复工作，因此我开始认真检查，将这三个编译器放在一起发现它们 90% 的代码是相同的。于是，我在脑海里为其他的 10% 建立了一个程序...

> lint 是一个有趣的故事。当我决定我真的要去写一个可移植编译器，将这三个编译器打造成一个真正可移植的版本，我知道怎样去做前端，但是对于代码生成我依然不太了解...所以我需要将前端代码全部检测，但是却没办法去检测。我想或许我可以在前端做一些有用的事情，如果它真的有用，人们将会用它检测自己的代码，也就是帮我测试了。然后，怎么样才是有用的呢？前端是支持解析函数的...我说好吧，一个经常出现的编程错误就是使用了错误的参数个数调用函数。实际上，指出是哪个函数并不是很容易办到。于是我写了一个程序，它可以读取你的代码文件，最初它会告诉你是哪个函数出错了。然后我意识到它可以在函数调用间也做测试。因此 lint 真的成为我调试编译器前端代码的一个工具。一言以蔽之，它在各种组织中扮演公共品行守卫者的角色。

> 你知道，当 1977 年我们第一次移植 Unix 的的时候，我们有一个非常严重的问题，我们有许多代码是人们看着手册写的，他们直接复制了手册上的数据结构声明。当我们介绍头文件的时候，我们设想了机器之间的不同。我们想确认 Unix 程序都是使用了头文件，特别是操作系统使用的那些头文件。因此 lint 学着去做的第一件事就是检查头文件的一致性...这让我们可以检查大量的代码——第六版的 Unix 只用了短短几个星期就解决了一致性问题。它帮助我们将它们合并到第七版的使用工具 (第七版是第一个可移植系统)。

克制住想谈论 Unix 没一件事情的冲动，在转移到通信前我们先专注于 **awk**。Peter Collinson 向 Brian Kernighan 请教关于 **awk** 的事情：

> 我想 **awk** 是从 1977 年开始出现的，到目前为止它是我参与过的最大的软件项目。我们中有三个人参与进来，但却完全没法工作。不知为什么，两个人在一起工作要远比三个人容易。工作分割非常困难。大家在想法上有很多分歧，这有时是好的因为意味着更多的创意，但是有时却意味着大家并不团结。换句话说和 Al Aho 以及 Peter Weinberger 一起工作非常非常的棒，所以我并没有那些问题。

> 一共有三个单独的进度在同时进行。我的那部分是那时还在实验室的 Mark Rochkind 做的一个工具。这是一个非常基础的数据验证工具，它使用成对的正则表达式和消息，通过扫描输入文件查找是否有符合给出的正则表达式，如果有的话我就会打印出消息。当然，他是用 C 语言写的这个识别器。这是一个非常优雅的主意。

> 某种程度上说，那时 **awk** 的基本概念。有一大堆的模式，还有许多互相依赖的东西要完成。它不像已有的那些程序，它是他们中非常清晰的一个。我也在可编程编辑器方面混了很长一段时间，我们经历了 **qed** 非常流行的阶段。**qed** 是一个非常糟糕的编程语言，但人们偏偏都在用它。

> 有一个行编辑器拥有与多个 buffer 和多个文件，非常像今天的 **emacs**。

> 我不停思考一定有更好的方式去操作文本。有些事情会像我想要的那样允许你清晰的同时操作文本和数字。

> Al Aho 在正则表达式方面是世界级的专家。Peter Weinberger 在数据库相关的方面有着非常强的背景，并且对数据库之类的东西非常感兴趣。现在，**awk** 绝对不是一个数据库，但是它有这方面的趋势，这来自 Peter 的数据库经验。因此，我们将这些混杂主意糅合到一起想做出一个东西。

> 它最初的想法是写一两行代码，真的是这样。我想它是非常迷人的因为它自动做了这么多事情。它流畅的处理字符串和数字。它是一个解释器并且没有包袱，没有中间文件。人们开始试着写一两行代码，然后代码越来越多，有一些大的难以置信，据说有人曾写出一万行的代码。

> **awk** 总是在慢慢变化。有一点可以追溯到我的那个想法，我真的希望有一个编程语言可以让我写程序操作文本就像操作数字一样方便。我想相比于 B 语言发展到 C 语言，我会去寻找另外一个方向。

> 我发明了一种我称之为 A 的语言，使用了 awk 的基本概念并且用编程语言将它们包装起来。它工作的并不太好。它有一些功能可以展示，但是它没有使用任何隐式的输入输出或其他类似的东西。我使用了它但是它始终都不够好。它的实现方式真的非常古怪，因此 我一直没怎么用它，也没有其他人用过它。

> 那时有一些 awk 的其他实现。特别是有一个 GNU 的版本叫做 gawk。它和我们的实现非常接近。当他们做 gawk 的时候和我们有非常多的联系来试着确保他们的版本和我们的尽可能同步。还有 DOS 的版本，我最熟悉的是 MKS 版本，当然，它也和我们的非常类似。最后，还有一个 POSIX 版本。POSIX 版本是标准化的 awk，那个时候它还是草稿阶段。

> 我们多多少少将这些写到了书里，通常我认为是这样。关于标准过程我认为有些好的争论点是有必要的。有一些是和书上冲突的：比如从数字转换到字符串和从字符串转到数字时变量的状态是什么。这类事情可能他们并没有讲清楚。POSIX 和我们在一些观点上有着不同的见解，对其其中的大多数，我想人们会同意主流意见。

Mail 存在于 Unix 非常早期的版本中，man 页中记载它的维护者是 Ken。它允许 Ken，dmr，doug，rhm 和其他一些人互相通信。它在其他分时系统上也是可以使用的。但是，就像 1940 年夏天 George Stibitz 曾经在达特沃斯州通过远程电传打字机使用了位于新泽西州的计算器，对远程工作的憧憬导致了想和其他人分享数据和程序。

最早的网络是 ARPANET(开始于 1969 年)，它打算实现资源共享：高级研究项目代理 (ARPA) 认为将他们主办的几个项目连接起来会比给它们每一个都购买昂贵的计算机设备更能节省资金。组织成员可以登录到其他成员的机器并且传送文件。文件传输协议 (ftp) 和远程登录协议 (telnet) 实现的非常早。由于之前没有可以网络工作的计算机，所以虽然已经有了机器内通信的 mail 程序，但却没有机器间通信的 mail。在 1970 年早期，计算机邮件已经比较常用。到 1973 年它已经足够流行以至于邮件头形成了一种事实上的标准。在 1970 年晚期，ARPANET 标准被重写，包含了 SMTP(简单邮件传送协议)。

1973 年最初邮件格式的模型是一个运行在流行的 DEC-10s 上面的 TENEX 操作系统。更多的成功发生在 DEC-20s 上面，他们的操作系统是 TOPS-20 或者 TWENEX(TWENEX 是由 BBN 开发的 TENEX 后续版本)。

但是 Unix 用户呢？

1976 年之前，从一个机器向另一个机器发送文件几乎是不可能的。那年的末尾，AT&T 研究室的 Mike Lesk 写了一个“更好的发行规划”(1977 年 1 月，小型系统通讯)，仅仅一个月之后它就被称之为 UUCP(Unix 到 Unix 的复制，一个程序从一个机器向另一个机器复制 Unix 文件)。它被设计为针对 300 波特率线路。**uucp** 最终在 1978 年发布，它因广泛的使用而被证明为是 Unix 最重要的部分之一。Lesk 的发明导致了改进的需求，因为原始程序如此流行以至于达到了它处理能力的上限。下个 **uucp** 版本由 Lesk，Dave Nowitz 和 Greg Chesson 重写，并出现在 1978 年 10 月的 Unix 第 7 版中。这个版本也被证明不足以胜任巨大的用户使用量 (更多的系统，更多的软件，更多的需求)，1983 年七月 Martin Levy 请求一个新的 **uucp** 系统。基于 1200 波特率异步调制解调器的 **uucp** 设计上达到巅峰，但也不足以满足不断增长的 Unix 网路需求。

1983 年 1 月中旬，在 AT&T 贝尔实验室召开了很多人参加的一个会议，会议的结果是由 Peter Honeyman，Dave Nowitz，还有 Brian Redman 一起开发 **uucp** 的新版本。最终成果就是著名的 HoneyDanBer，或者叫 BasicNetworkingUtilities1。

我和 Brian Redman 聊他的工作：

> 我在亚利桑那州取得硕士学位，在 1978 年 6 月去了实验室。我在 1977 年取得了微生物学的学士学位，我妻子在下一年也去了。但是我为之工作的那个家伙离开了我没有留下任何资金。因此我去另一个生物学的家伙那得到一个维护计算机的工作。我在计算机科学部门学了一些计算机的课程，在亚利桑那那是非常新的知识。然后我意识到我可以在那年拿到计算机科学的学士学位。不管怎么说，我还沉浸在学业的时候，后来成为我引导者的 David Hansen 从实验室带着一些人来面试。他对学生们说:“如果你有手有脚，你就能在实验室赚大钱”。我猜他假设教室里每个人都有一个脑袋。

> 所以我去面试了。最初我面试的是西部电子在普林斯顿的一个工作，并且我会在 DEC-10 上工作，我印象非常深刻。我在维泊尼和霍姆德尔面试了贝尔实验室并且得到维泊尼的一份工作。因此我妻子刚一毕业我们就搬到了新泽西。

> 于是我开始在维泊尼的环路传输部门工作。我不能相信我可以拿钱做这个计算机工作。

> 我第一次见到 Unix 是在我的操作系统课程上，当我读论文的时候。我们在计算机科学中心有一个 Unix，但是我一直都是使用 DEC-10 运行 TOPS。因此我真正第一次接触 Unix 是在我到了贝尔实验室之后。我为 Ratfor 工作，那本 *软件工具* 对我来说真的是一本启蒙书。我非常欣赏简单，模块，重用的概念。

> 但我当我到贝尔实验室之后，他们说:“你将使用 Unix 系统，这有一个程序叫 **learn**”。它会向你提供一些信息，并且会问你问题。我记得我输入我的答案，然后它说“不，错了”。但是我确信我是对的，于是我退出程序然后开始查找程序的位置。我找到那个程序，还有它的数据库，它的所有答案。我开始深入了解它，明白它是如何工作的 (**learn** 最初是由 Lesk 发起，由 Kernighan 和 Lesk 一起开发。它包含在第 7 版 Unix 中，并且也包含在 BSD 中。但是并没有在第 3 版和第 5 版中出现)。

> 你知道，如果它是一本书，我就会看它的背面。但是他是一台计算机，那么我就看它的文件系统。

> 我的老板 Doug Cory 成为 Unix 电话网络最早的用户之一。一个名为 COSMOS 的系统为我们布线，后来它叫做 COSMIX。COSMOS 一台 11/70。实际上，我有这台机器的前面板，序列号 5001，并且我被告知它是美国第一个卖出的 11/70。无论如何，我们在一台名为 wh5ess 的 11/45 上使用 mail。Sam Arnold 和 Lesk 发起了新的工具 **uucp**。我对它非常有兴趣并且成了管理员，因为我们有了越来越多的用户。我发现我能从莫里山使用 **uucp** 的用户那接收信息，有时我们会将 11/45 换成 11/70，因此我们有了更强大的机器。

> 我们得到的第一台 VAX 是 mothra。那时我们运行 300 波特率，之后得到了一个新的调制解调器，因此我们可以运行在 1200 波特率。然后是 glass 终端，再之后就是这台巨大的机器。于是我问为什么我们不能运行的更快些。他们告诉我你可以在 50 英尺的距离运行 RS-232，但是现在是 150 英尺。因此我对自己说，好吧，我用不上 9600，只能用慢一些的，但仍然要高于 1200。于是我扯了一条线，我的到了 9600 的速度，之后又达到了 19200。我的同事说“嘿，也给我来一条”。于是我将它成立了一个项目，我在楼下放了一个接线板，在它上面用上了最先进的技术。这非常有意思，那个时候，我有几百个用户，我花费整个周末让每件事都看起来非常漂亮。我们开始在线路上收到噪音和干扰，因为所有的东西都是并联运行。于是我将他们通通分离，然后把他们再弄成一团，所有事情就都工作的很好。

> 我开始和计算机中心一起工作。他们有一个排版机用来制作文档。我通过图像排版机放入 man 页。我试着让系统变得更有用 ()。不管怎么说，79 年我第一次去了圣莫尼卡举办的 USENIX 会议。我听到了我所期望的事情并且见到很多人。我希望从维泊尼发送东西到计算机中心。因此我加入了 **uucp**。1980 年我在特拉华州见到了 Peter Honeyman。那时我第一次和他在一起...

> 我去参加会议，在会上见到了很多人。我们大家交换电话号码，因为大家没法得到对方的邮件。Clem Cole 是我记得的一个人，他有一些东西。我不知道是什么但是是一些我想要的东西。我们有 8 个调制解调器，这在今天非常普通，但是那时大多数员工只有一两个。他在泰克公司，因此我会给 Clem 打电话说“我们来发起一个连接”，接着我们就那么做。伯克利发出了第二个发行版。我记得他们说“我们可以向你发送磁带”，我说“我不能等了”，于是我们发起了 **uucp** 连接。

Clem Cole 曾经是卡内基梅隆大学的一名学生，在哪里他和 Ted Kowalski 将 Unix 第 6 版从计算机中心的 PDP-11 移植到了电子工程部门的 11/34(就如 Cole 和我说的，这件事请“绝非易事，因为卡内基梅隆大学为'e'机器做了非常多的 hack，而 Unix 第 6 版不能支持 34s”)。

Cole 后来去了梅隆协会工作，他在那里和 Dan Klein 培育了 Unix，并且当协会购买“第一个 RK07's(我记得是#17 系列)，Dan 和我一起用了一周时间为它写了第一个驱动。RK07 给了我们 2000 万！——多到无穷！”。

Cole 从卡内基梅隆拿到学位，在俄勒冈州的泰克公司得到一份工作。

> 我在 1979 年去了那里。在我到那之前的几个月，Steve Glaser 发现了一台运行 RSX 的 11/60，确认泰克会购买一个 2 万美金的 Unix 第 6 版授权，并在它上面运行 Unix。由于 60 并不是一台真正的 11/40(类似但不完全相同)，我在俄勒冈的第一个周末就是和 Steve 一起拆开 60 把卡内基梅隆大学修改的地方还原回去...

> 我在俄勒冈州的第一个圣诞节是和 Rick LeFaivre，Steve 一起动手安装 PDP-11/70。那台机器成为第二台主要的 **uucp** 工作站，“teklabs”运行 V7，我们每天都和“Marxs”通信 (Cole 谈到了新泽西贝尔实验室的 chico 和 harpo。1981 年的 USENET 地图上标注了 teklabs-chico 的连接)。

> 我们为 VMS 写了第一个 TCP，它在今天依然存在，被称为“CMU-Tek”TCP。我们用 70 帮助着建立了“Magnolia”，一个 68000 多处理器 Unix 工作站，它运行我和 Steve 基于 Unix 改写的操作系统 Magix。我们得到一场爆炸！

> Brian Redman 和我每天都会通过 **uucp** 讨论一些重要的问题，例如用 C 语言编译器编译“冒险”游戏。事实上，我怀疑我们分享微处理器开发工具要比这些有趣的问题要少。当然我们也分享了 11/70 的改变和增强。我们有一个共同的敌人——Digital，它不乐意 Unix 是在他们的帮助下推广的。

Redman 继续说着他的故事：

> 我发现我还会定期通过发送电子邮件联系，所以我们有了一个社区，这就是 NETNEWS 的由来 (Usenet 起源于 1979 年杜克大学毕业生 Jim Ellis 和 Tom Truscott 的一个主意。Usenet 的第一个实现是 Steve Bellovin 写的，它是北卡罗莱纳州立大学的毕业生。USENET 在 1979 年用于杜克大学 (**duke**) 和北卡罗莱纳州立大学 (**unc**) 交换信息。1980 年 **phs** 加入进来。Armando Stettner 和 Bill Shannon 组建了第一条东西部连接线路——**duke** 到 **ucbvax**，同年也建立了到 **decvax** 的线路。USENET 现在是一个包含 5000 多个组织和几百万用户的巨 D 大无中心分散系统)。

> 我立即在 chico 搭建了 NETNEWS。我记得花费了相当多的时间表达一个非常聪明的问题，因此我得到一个非常聪明的答案。这全部是出于一种渴望。甚至于好的目的，当一些人说“我会为你制作一盘磁带”和“我会寄一盘磁带给你”...这些都不够好。

> 那就是它开始的时候：当 NETNEWS 开始出现，**uucp** 坏掉了。Lesk 根本没有考虑 **uucp** 现在会用作什么用途，也没有考虑到传送的内容。我的问题是 NETNEWS 上创建了数量巨大的文件，当这些文件开始传送的时候，Unix 会执行 **uuxqt** 命令。但是当磁盘负载很高的时候，连接就会偶尔死掉。并且在恢复之前，另一个 **uucp** 和几百个更多的文件又开始传送。而当你进到目录里看时系统就会超时，因为有太多东西需要列出来。所以我对 **uucp** 的第一个重要贡献是我让 **uucp** 可以为不同的站点使用不同的目录。

> 不管怎么说，我做了那些事情。Honeyman 发出一封邮件说“让我们一起讨论下 UUCP 的事情。我们把所有的修改放在一起，然后将它提供给每一个用户，这样我们就都运行着同样的东西”。于是我们发出一个通知，并且在莫里山举办里一个会议。哥伦布的 Mark Horton，Honeyman，我，Bellovin，以及实验室的所有运行系统的人都参加了会议。我想 Honeyman 有一个出席列表。根本上，Honeyman，Dave Nowitz 和我一起将所有修改合并在一起。Steve Bellovin 也做了很大的贡献。我们在那天晚上开始动手。事实大家分工非常好：我做目录相关的事情，Nowitz 对于安全更感兴趣。所以我们一起分工合作并且做的非常棒。

Bellovin 改进了他为 NETNEWS 写的代码，然后 Steve Daniel 和 Truscott 都做了改进。最后的结果是 **A News**。1981 年，毕业于伯克利大学的 Mark Horton 和高中生 Matt Glickman 将 **A News** 重写成为 **B News**。1987 年多伦多大学的 Henry Spencer 和 Geoff Collyer 做出另一个选择 **C News**。还有另外很多有用的 NETNEWS 修改版本，Spencer Thomas，Rick Adams，Ray Essick，Bob Kolstad，以及其他很多人都做出了自己的版本。但是让我们返回到 UUCP。

感谢 Peter Honeyman，这是他在 1983 年会议上的部分会议记录 (用他独特的文字):

> uucp 爱好者的第一次 (也是最后一次) 会议在 1983 年 4 月 20 号举办。邀请了 allegra！honey，vax135！martin，eagle！karn，rabbit！ark，mhb5b！smb，harpo！ber，cbosgd！mark，floyd！trb，research！rtm 和 eagle！dan。另外还有 USG 的代表 mhtsa！sc 和 mhtsa！brad，whuxlb！pep 和 gummo！mmp.下面是未删减的会议记录。

> ```
>
From: Honey Wed Apr 20 00:46:26 1983
To: uucplovers
Subject: minutes
Cc: dmr doug

```

> 原谅我下面的文字编辑，由 Levy 组织的一个讨论 uucp 问题的会议的记录。会上的记录人员有：

> eagle！dan，vax135！martin，ihnp4！gjm，gummo！ber，mhtsa！lsc，mhb5b！smb，mhtsa！brad，eagle！karn，whuxlb！pep，allegra！honey。

> 第一个讨论话题是企业电子邮件项目和它的伴生项目网络功能中心。网络中心上有 452 个成员和 774 个设备与组织共同管理。Murakani 给人的印象是这在实验室是固有设备的起始阶段，其他任何问题都是临时的。L.sys 数据库正因为新的数据库和新的的标准不断出现而逐渐走向失败。每个月关于 L.sys 意义的讨论最后得到了一致意见，工作站应该继续维护一个本地的 L.sys，并且那个本地文件应该首先被搜索。参与的人有 la koenig，honeyman 以及所有人。

> 关于修改 uucp 的活跃讨论占据了会议的大部分时间。就像有终端版本的 uucp，工作站也有众多版本。其中最主要的竞争者是由 Robert T. Morris 最初写成后来又经 Tom Truscott 修改的 usg 6.0。Cohen 严肃谨慎地对待将优秀功能集成到 6.0 过程中的各种困难。虽然如此，商业公司也参与进来，我们对他们表示欢迎。并且我们同意以此组织为起点来开发一个满足每个人的版本 (特别是我们自己)。

> 被强烈提议的是 spool 目录的构成方案。当 Truscott 为 C，D 文件使用不同目录 (我猜其他文件也一样)，Redman 和其他人都使用远程工作站的名字作为子目录。热烈的讨论持续不断，最后获得的一致意见是后者更为强健。Levy 的关于目录构成应该包含机器名字简短前缀的提议受到大家的欢迎。当 usg 中使用 setuid 进程执行 mkdir 成为一个问题，Bellovin 为了推翻这个特性耐心的解释技巧。经过三或四次跑题，会议再回到正轨，让人感觉 cico 或者其他的守护进程应该在 spoll 目录执行 rmdir，最终没有得到大家都同意的目录构成方案，我想在信息时代这个问题应该在更合适的态度下讨论。

> ...

> 最终我们同意使用最新 6.0 版本的 uucp，并对它进行大量的修改 (比如修复 bug，让它工作的更好)。Honeyman 领取了 conn.c，Redman 会修改脱机部分，Levy 愿意去写一个 L.sys 编辑器并且帮助 Murakami 标准化 L.sys 的行为。Bellovin 接受将脱机目录的修改移植到 uuxqt。当 Nowitz 反对对于 ifdefs 的依赖时，Cohen 指出 usg 不可能欣赏在 usg 保护下的任何事情。感觉就像我们可以隐藏特性到一个单独文件并且将我们的努力成果掩饰成一个向着 Unix 第 7 版兼容性做出的手势，一个显而易见但是愚蠢的谎言。总之，这个问题并不重要。

> 议程上的最后一个话题是组织提高安全意识方面的尝试。随后就开始了争吵。在各种和各方面的名誉遭到破坏的过程中，无疑引起疯狂但并不危险的反应，最后名没有得出好的结果。Honeyman 不赞成 Mcilroy 青睐的允许远程机器拉取文件的主张，转而支持在除本地集群意外的机器上禁止这种能力，继而建议可以从非 uucppublic 目录拉取一个许可文件 (这样远程工作站就不能拉取其他工作站发送的文件)。Redman 指出 L.sys 中唯一值得保护的信息是电话号码 (当然是数据中最安全的一部分)。Redman 请求大家对于即将到来的 GEI 规章的意见。

> 接下来是空空肠胃发出引人注意的巨大声音。人们一致做出一个决定，先暂时休会大家一起去附件的一家中国饭馆，这是那时候各地 uucp 黑客的传统。这个决定随后修改为去橡树屋 (一个不好的前兆)。

橡树屋是莫里山贝尔实验室的咖啡厅，之前几年提供餐桌服务。

在 uucp 漫长的讨论之前，我提到了 ARPANET，TCP，以及 ping。由于 Mike Muuss 参与了 TCP 早期版本的开发，并且也是 ping 的作者，我想有必要说一说他的故事。

> 我毕业于霍普金斯大学，我有一个相当独特的职位：运行 RSTS(DEC 的资源共享分时系统) 的 PDP-11/45。我到的时候它每天只运行几个小时的 Unix。部门说我们除非我们也能运行 RSTS，否则我们不能运行 Unix...因此我们把它实现了，它成为我们的第一个软件项目——在 Unix 上运行 RSTS。我们真正开始工作是在 75 年后半年，我们在秋天开始转向第 6 版。

Muuss 在 1979 年毕业于约翰霍普金斯大学，之后去了弹道研究实验室工作。那年的 9 月他的工作是于设计实现 BRLNET 本地高速网络的原型，这个项目是一个和美国军队签订的合约。1980 年早期 Muuss 扩展了 BRLNET 协议，并且领导一个小组将伊利诺斯州立大学的 NCP 移植到 PDP-11 上的 Unix。那个团队配备了一个 11/34。1981 年后期，Muuss 定义了实验性的 TCP/IP 协议，并且着手在 PDP-11 上的 BRL/JHU Unix 上实现它，BRLNET 则没有继续研究。可能更重要的是 Muuss 通过 ARPANET 和 USENET 向 7000 多名订阅者发布了 TCP/IP 摘要。最重要的是，Muuss 的工作包含在两个 MIL(军事) 标准里面：1777 和 1778。几乎每个现在的 TCP/IP 实现都包含了 Muuss 在 BRL 开发的软件。Muuss 告诉我：

> 我们甚至有段时间参与到通讯行业。Ron Natalie 是我在那里的主要开发者。我们开发了一个小的操作系统并且将所有东西使用 PDP-11 通过 ARPANET 发送了出去。所以我们算是参与了通讯商业。然后，在 1983 年我们完成了下一个大步骤，争取到了光纤补助。AT&T 展出了带状线光纤...我们一箱光纤，一共有 145 根。我们用他们立即组建了一个全光纤的局域网。

那是 10 年前的事情了。根据出版物资料，1984 年 BRL 的网络是非并行的。TCP/IP 协议到了 BBN 和伯克利。我会在第 18 章再次讲述协议的开发。
